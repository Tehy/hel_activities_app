(this.webpackJsonphelsinki_activitites_app=this.webpackJsonphelsinki_activitites_app||[]).push([[0],{17:function(e,t,a){e.exports=a(42)},22:function(e,t,a){},24:function(e,t,a){},42:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),u=a.n(c),s=(a(22),a(6)),i=a(1),o=a.n(i),l=a(2),m=a(3),p=(a(24),a(5)),f=a.n(p),d=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/data");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/data/id/"+t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/data/tag/"+t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/data/limit/"+t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/data/items/"+t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.post("/api/user",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),w=function(e){var t=e.setShowNewUserForm,a=e.setNotification,c=Object(n.useState)("demo-user"),u=Object(m.a)(c,2),s=u[0],i=u[1],p=Object(n.useState)("demo-user"),f=Object(m.a)(p,2),d=f[0],v=f[1],b=function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""===s||""===d){e.next=8;break}return e.next=4,h({username:s,password:d});case 4:200===(n=e.sent).status?(a("user-created"),i(""),v("")):n.message&&n.message.includes("401")&&a("username-error"),e.next=9;break;case 8:a("empty");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"new-user-form"},r.a.createElement("form",{onSubmit:b},"name",r.a.createElement("input",{onChange:function(e){i(e.target.value)},value:s,name:"name"}),r.a.createElement("br",null),"password",r.a.createElement("input",{onChange:function(e){v(e.target.value)},value:d,name:"password"}),r.a.createElement("br",null),r.a.createElement("button",{type:"submit"},"Create user")),r.a.createElement("button",{onClick:function(){t(!1)}},"Cancel"))},k=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.post("/api/login",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),O=function(e){var t=e.userSet,a=e.setShowLoginForm,c=e.setNotification,u=Object(n.useState)("demo-user"),s=Object(m.a)(u,2),i=s[0],p=s[1],f=Object(n.useState)("demo-user"),d=Object(m.a)(f,2),v=d[0],b=d[1],g=function(){var e=Object(l.a)(o.a.mark((function e(a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),""===i||""===v){e.next=6;break}return e.next=4,k({username:i,password:v});case 4:200===(n=e.sent).status?(t(n.data),c("success")):c("error");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:g},"name",r.a.createElement("input",{value:i,onChange:function(e){p(e.target.value)}}),r.a.createElement("br",null),"password",r.a.createElement("input",{value:v,onChange:function(e){b(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("button",{type:"submit"},"Login")),r.a.createElement("button",{onClick:function(){a(!1)}},"Cancel"))};function x(e){var t,a=e.data,n=e.backBtnOnclick;return r.a.createElement("div",{className:"single-data"},r.a.createElement("button",{onClick:n},"Go back"),r.a.createElement("br",null),a.name.fi&&r.a.createElement(r.a.Fragment,null,"Tapahtuma: ",a.name.fi," ",r.a.createElement("br",null)),a.info_url&&r.a.createElement(r.a.Fragment,null,"Linkki:"," ",r.a.createElement("a",{href:a.info_url,target:"_blank",rel:"noopener noreferrer"},a.info_url)," ",r.a.createElement("br",null)),a.modified_at&&r.a.createElement(r.a.Fragment,null,"Muokattu:"," ",a.modified_at.substring(0,a.modified_at.length-5).replace("T"," ")," ",r.a.createElement("br",null)),a.location&&r.a.createElement(r.a.Fragment,null,"Sijainti: ",a.location.address.street_address,","," ",a.location.address.locality," ",r.a.createElement("br",null)),a.description.body&&r.a.createElement(r.a.Fragment,null,"Kuvaus:"," ",r.a.createElement("div",{dangerouslySetInnerHTML:(t=a.description.body,{__html:t})})," "),a.where_when_duration&&r.a.createElement(r.a.Fragment,null,"Miss\xe4 ja million: ",a.where_when_duration.where_and_when,r.a.createElement("br",null),"Kesto: ",a.where_when_duration.duration,r.a.createElement("br",null)),a.description.images&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Tapahtuma kuvia:"),r.a.createElement("div",{className:"images"},a.description.images.map((function(e){return r.a.createElement("a",{className:"image",href:e.url,target:"_blank",rel:"noopener noreferrer",key:e.url},r.a.createElement("img",{src:e.url,width:"200",className:"img",alt:"activity"}))}))," ",r.a.createElement("br",null))))}var j=function(e){var t=e.activityId,a=e.user,n=e.saveBtnOnclick,c=e.removeBtnOnclick,u=a.savedItems.includes(t)?r.a.createElement("button",{onClick:function(){c(a,t)}},"Remove"):r.a.createElement("button",{onClick:function(){n(a,t)}},"Save");return a.savedItems?u:r.a.createElement(r.a.Fragment,null)},y=function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.post("/db",{id:t,username:a});case 3:return n=e.sent,e.abrupt("return",n.status);case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}(),S=function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=f.a.delete("/db",{data:{id:t,username:a}}),e.abrupt("return",n.data);case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,a){return e.apply(this,arguments)}}(),N=function(e){var t=e.tags,a=e.updateTag,n=e.tagOnClick;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"tags"},"Page Tags:",r.a.createElement("br",null),t.map((function(e){return r.a.createElement("div",{key:e[0],className:"tags-tag",onClick:Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n(e[0]),a(e[1]);case 2:case"end":return t.stop()}}),t)})))},e[1],"        ")}))))},I=function(e){var t=e.state,a=e.updateState,c=e.user,u=e.updateUserWithItem,s=e.removeUserItem,i=Object(n.useState)("limit=10&start=0"),p=Object(m.a)(i,2),f=p[0],E=p[1],h=Object(n.useState)(),w=Object(m.a)(h,2),k=w[0],O=w[1],I=JSON.parse(t),_=I.meta,C=I.data,F=Object.entries(I.tags),U=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,g(f);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,b(t);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(l.a)(o.a.mark((function e(t,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(a,t.username);case 2:s(t,a);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),J=function(){var e=Object(l.a)(o.a.mark((function e(t,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(a,t.username);case 2:u(t,a);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,_&&r.a.createElement("div",{className:"meta"},_.count&&r.a.createElement("div",{className:"count"},_.count," ",k&&r.a.createElement("div",{style:{fontWeight:"bold",display:"inline"},className:"tag"},k)," ","activities found",r.a.createElement("br",null),r.a.createElement("div",{style:{fontSize:"small"}},"results"," ",_.next?parseInt(_.next.split("=").pop())-10+" - "+_.next.split("=").pop():_.count-_.count%10+" - "+_.count)),_.previous&&r.a.createElement("img",{className:"nav-buttons",alt:"arrow left",src:"arrow_left.png",onClick:Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_.previous.split("?").pop(),e.t0=a,e.next=4,g(t);case 4:e.t1=e.sent,(0,e.t0)(e.t1),E("limit=10&start="+t.split("=").pop());case 7:case"end":return e.stop()}}),e)})))}),_.next&&r.a.createElement("img",{className:"nav-buttons",alt:"arrow right",src:"arrow_right.png",onClick:Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_.next.split("?").pop(),e.t0=a,e.next=4,g(t);case 4:e.t1=e.sent,(0,e.t0)(e.t1),E("limit=10&start="+t.split("=").pop());case 7:case"end":return e.stop()}}),e)})))}),_.next||_.previous?r.a.createElement(r.a.Fragment,null):r.a.createElement("button",{onClick:Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,d();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))},"Go back")),C?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"data"},C.map((function(e){return r.a.createElement("div",{className:"data-item",key:e.id},r.a.createElement("span",{onClick:Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=a,t.next=3,v(e.id);case 3:t.t1=t.sent,(0,t.t0)(t.t1);case 5:case"end":return t.stop()}}),t)})))},e.name.fi),r.a.createElement("br",null),e.tags.map((function(e){return r.a.createElement("div",{className:"data-item-tags",key:e.id},e.name," ")})),c&&r.a.createElement(j,{activityId:e.id,user:c,saveBtnOnclick:J,removeBtnOnclick:B}),r.a.createElement("br",null))}))),r.a.createElement(N,{tags:F,updateTag:T,tagOnClick:L})):r.a.createElement(x,{data:I,backBtnOnclick:U}))},_=function(e){var t=e.logout,a=e.username,n=e.savedItems,c=e.updateData;return r.a.createElement("div",{className:"user-info"},r.a.createElement("p",null,"User ",r.a.createElement("span",{style:{fontWeight:"bold"}},a," "),"logged in. You have",r.a.createElement("span",{style:{fontWeight:"bold"}}," ",n.length," "),"activities ",r.a.createElement("button",{onClick:t},"Logout")," ",n.length>0?r.a.createElement("button",{onClick:Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,E(n);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))},"Your Activities"):r.a.createElement(r.a.Fragment,null))," ")},C=function(){return r.a.createElement("div",{className:"header"},r.a.createElement("h1",null,"My Helsinki Activities App"))},F=function(e){var t,a,n=e.type;return"error"===n?(t="notification-error",a="wrong username or password"):"success"===n?(t="notification-success",a="login success"):"empty"===n?(t="notification-error",a="cannot have empty fields"):"username-error"===n?(t="notification-error",a="username taken"):"user-created"===n&&(t="notification-success",a="user created"),r.a.createElement("div",{className:t},a)};var U=function(){var e=Object(n.useState)(),t=Object(m.a)(e,2),a=t[0],c=t[1],u=Object(n.useState)(),i=Object(m.a)(u,2),p=i[0],f=i[1],v=Object(n.useState)(!1),b=Object(m.a)(v,2),g=b[0],E=b[1],h=Object(n.useState)(!1),k=Object(m.a)(h,2),x=k[0],j=k[1],y=Object(n.useState)(),S=Object(m.a)(y,2),N=S[0],U=S[1];Object(n.useEffect)((function(){setTimeout((function(){U()}),4e3)}),[N]),Object(n.useEffect)((function(){Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,d();case 3:e.t1=e.sent,(0,e.t0)(e.t1),localStorage.getItem("loggedInUser")&&(t=JSON.parse(localStorage.getItem("loggedInUser")),f(t));case 6:case"end":return e.stop()}}),e)})))()}),[]);var L,T=function(e){c(e)},B=function(e){localStorage.setItem("loggedInUser",JSON.stringify(e))},J=function(e,t){var a=e.indexOf(t);return e.splice(a,1)},M=function(){return g?(j(!0),E(!1)):j(!0)},W=function(){return x?(j(!1),E(!0)):E(!0)},A=function(e){f(e),B(e),E(!1),j(!1),Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,d();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))()},D=function(){f(),c(),localStorage.removeItem("loggedInUser")},G=function(e){U(e)},H=function(){return p?r.a.createElement(_,{username:p.username,savedItems:p.savedItems,logout:D,updateData:T}):r.a.createElement("div",{className:"user-forms"},r.a.createElement("button",{onClick:M},"Login"),r.a.createElement("button",{onClick:W},"Create User"),x&&r.a.createElement(O,{setNotification:G,userSet:A,setShowLoginForm:j}),g&&r.a.createElement(w,{setNotification:G,setShowNewUserForm:E}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,null),N&&(L=N,r.a.createElement(F,{type:L})),p?a?r.a.createElement(r.a.Fragment,null,H(),r.a.createElement("div",{className:"App"},r.a.createElement(I,{user:p,updateState:T,state:a,updateUserWithItem:function(e,t){var a=Object(s.a)({savedItems:e.savedItems.push(t)},e);f(a),B(a)},removeUserItem:function(e,t){var a=Object(s.a)({savedItems:J(e.savedItems,t)},e);f(a),B(a)}}))):r.a.createElement("h2",null,"Loading..."):H())};u.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(U,null)),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.132e714b.chunk.js.map